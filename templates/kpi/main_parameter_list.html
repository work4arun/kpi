{% extends 'base.html' %}

{% block title %}KPI Configuration{% endblock %}

{% block content %}
<div class="animate-fade-in">
    <!-- Page Header -->
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-2xl">
        <div>
            <h1 class="text-4xl font-bold mb-md" style="color: var(--text-primary);">KPI Configuration</h1>
            <p class="text-lg" style="color: var(--text-secondary);">Manage main parameters and their configurations</p>
        </div>
        <a href="/admin/kpi/mainparameter/add/" class="aws-btn aws-btn-primary">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
            </svg>
            Add Main Parameter
        </a>
    </div>

    <!-- KPI Parameters Table -->
    <div class="aws-table-container mb-2xl hover-lift">
        <table class="aws-table aws-table-striped">
            <thead>
                <tr>
                    <th>Parameter Name</th>
                    <th>Role Owner</th>
                    <th>Weightage</th>
                    <th>Sub-Parameters</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for param in parameters %}
                <tr>
                    <td>
                        <div class="font-semibold" style="color: var(--text-primary);">{{ param.name }}</div>
                    </td>
                    <td>
                        <span class="aws-badge aws-badge-info">{{ param.get_role_owner_display }}</span>
                    </td>
                    <td>
                        <span class="font-bold" style="color: var(--aws-orange);">{{ param.weightage }}%</span>
                    </td>
                    <td>
                        <span style="color: var(--text-secondary);">{{ param.sub_parameters.count }} parameters</span>
                    </td>
                    <td>
                        {% if param.is_active %}
                        <span class="aws-badge aws-badge-success">Active</span>
                        {% else %}
                        <span class="aws-badge aws-badge-secondary">Inactive</span>
                        {% endif %}
                    </td>
                    <td>
                        <div class="flex gap-sm">
                            <a href="/admin/kpi/mainparameter/{{ param.id }}/change/" 
                               class="aws-btn aws-btn-outline aws-btn-sm"
                               title="Edit Parameter">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                </svg>
                            </a>
                        </div>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" class="text-center py-xl">
                        <div class="flex flex-col items-center justify-center gap-md">
                            <svg class="w-16 h-16" style="color: var(--text-tertiary);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"/>
                            </svg>
                            <p class="font-semibold" style="color: var(--text-secondary);">No KPI parameters configured yet</p>
                            <a href="/admin/kpi/mainparameter/add/" class="aws-btn aws-btn-primary aws-btn-sm">Create First Parameter</a>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Stats Cards -->
    {% if parameters %}
    <div class="grid grid-cols-1 md:grid-cols-3 gap-lg">
        <div class="aws-stat-card hover-lift">
            <p class="aws-stat-value">{{ parameters|length }}</p>
            <p class="aws-stat-label">Total Parameters</p>
        </div>
        <div class="aws-stat-card hover-lift">
            <p class="aws-stat-value">{{ parameters|length }}</p>
            <p class="aws-stat-label">Active Parameters</p>
        </div>
        <div class="aws-stat-card hover-lift">
            <p class="aws-stat-value">
                {% widthratio parameters|length 1 100 %}%
            </p>
            <p class="aws-stat-label">Configuration Complete</p>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
